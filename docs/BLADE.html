<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> 2 BLADE | ABS DataLab Manual</title>
<meta name="author" content="Elyse Dwyer">
<meta name="description" content="2.1 General Structure of BLADE BLADE is stored in the Product network drive of your virtual machine in DataLab. There are separate folders for different file types, I recommend working with csv...">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content=" 2 BLADE | ABS DataLab Manual">
<meta property="og:type" content="book">
<meta property="og:description" content="2.1 General Structure of BLADE BLADE is stored in the Product network drive of your virtual machine in DataLab. There are separate folders for different file types, I recommend working with csv...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content=" 2 BLADE | ABS DataLab Manual">
<meta name="twitter:description" content="2.1 General Structure of BLADE BLADE is stored in the Product network drive of your virtual machine in DataLab. There are separate folders for different file types, I recommend working with csv...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">ABS DataLab Manual</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Preface</a></li>
<li><a class="active" href="BLADE.html"><span class="header-section-number">2</span> BLADE</a></li>
<li><a class="" href="madip.html"><span class="header-section-number">3</span> MADIP</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="BLADE" class="section level1" number="2">
<h1>
<span class="header-section-number"> 2</span> BLADE<a class="anchor" aria-label="anchor" href="#BLADE"><i class="fas fa-link"></i></a>
</h1>
<div id="general-structure-of-blade" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> General Structure of BLADE<a class="anchor" aria-label="anchor" href="#general-structure-of-blade"><i class="fas fa-link"></i></a>
</h2>
<p>BLADE is stored in the Product network drive of your virtual machine in DataLab. There are separate folders for different file types, I recommend working with csv files if you are an R or Python user. There is a separate csv file for each financial year and source, e.g. one file will represent BAS returns in FY18-19. Alongside general data cleaning, you will need to merge across different sources, as well as appending data for each year, if you are interested in panel data.</p>
<p>The ‘core’ of BLADE consists of four different data sources containing administrative data which most businesses will complete during the financial year:</p>
<ul>
<li>Indicative Data Items: This contains the ‘spine’ of ABNs from which all other datasets can be linked.</li>
<li>BAS: These are filled out by all firms that remit GST and include information on sales, operating expenses, purchases and capital expenditures</li>
<li>BIT: These files contain income tax data (including balance sheet data) that is submitted to the ATO.</li>
<li>PAYG: This contains information on employee headcount and wages expense when payment summaries are submitted to the ATO.</li>
</ul>
<p>There are other datasets within the extended version of BLADE which cover R &amp; D expenses and customs data, however these tend to cover a smaller proportion of firms within the population.</p>
<div id="tau-or-abn-levels" class="section level3" number="2.1.1">
<h3>
<span class="header-section-number">2.1.1</span> TAU or ABN levels<a class="anchor" aria-label="anchor" href="#tau-or-abn-levels"><i class="fas fa-link"></i></a>
</h3>
<p>There are two levels of observation inside BLADE, the ABN level, which encompasses a legal entity and the TAU level, which attempts to identify the ‘economic firm’. A TAU may consist of multiple ABNs, for example, all of the legal entities that Kmart Australia operates would be aggregated into one TAU. TAUs can be aggregated further into an enterprise id, which in the case of Kmart, would identify its parent company Wesfarmers Ltd. </p>
</div>
</div>
<div id="blade-utils-in-r" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> BLADE Utils in R<a class="anchor" aria-label="anchor" href="#blade-utils-in-r"><i class="fas fa-link"></i></a>
</h2>
<div id="append-multiple-time-periods-together" class="section level3" number="2.2.1">
<h3>
<span class="header-section-number">2.2.1</span> Append multiple time periods together<a class="anchor" aria-label="anchor" href="#append-multiple-time-periods-together"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/HenrikBengtsson/matrixStats">matrixStats</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com">data.table</a></span><span class="op">)</span>

<span class="va">blade_path</span> <span class="op">&lt;-</span> <span class="st">" "</span> <span class="co"># Directory containing BLADE source files in CSV format</span>

<span class="va">destination_path</span> <span class="op">&lt;-</span><span class="st">"  "</span> <span class="co"># Directory where merged files will go</span>

<span class="va">file_patterns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"frame"</span>, <span class="st">"BAS"</span>, <span class="st">"BIT"</span>, <span class="st">"PAYG"</span><span class="op">)</span> <span class="co"># File path patterns</span>

<span class="va">dest_patterns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ind_items.csv"</span>, <span class="st">"BAS.csv"</span>, <span class="st">"BIT.csv"</span>, <span class="st">"PAYG.csv"</span><span class="op">)</span> <span class="co"># Destination files</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">{</span>

    <span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="va">path</span>, pattern<span class="op">=</span><span class="va">file_patterns</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, full.names<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
    <span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">files</span>, <span class="va">fread</span><span class="op">)</span>
    <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">files</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">files</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">files</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="va">source</span><span class="op">:=</span><span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">j</span>,<span class="va">files</span><span class="op">)</span><span class="op">+</span><span class="fl">10</span><span class="op">]</span>
    <span class="op">}</span>
    <span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbindlist</a></span><span class="op">(</span><span class="va">files</span><span class="op">)</span>
    <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fwrite.html">fwrite</a></span><span class="op">(</span><span class="va">files</span>,file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">destination_path</span>, <span class="va">dest_patterns</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, sep<span class="op">=</span><span class="st">"/"</span><span class="op">)</span><span class="op">)</span>

<span class="op">}</span></code></pre></div>
</div>
<div id="merging-blade-core-datasets" class="section level3" number="2.2.2">
<h3>
<span class="header-section-number">2.2.2</span> Merging BLADE core datasets<a class="anchor" aria-label="anchor" href="#merging-blade-core-datasets"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># This is assuming you have completed the appending step</span>

<span class="co"># Read in the files you saved down</span>

<span class="va">objects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ind_items"</span>, <span class="st">"BAS"</span>, <span class="st">"BIT"</span>, <span class="st">"PAYG"</span><span class="op">)</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">{</span>
  
    <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">objects</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html">fread</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">destination_path</span>, <span class="va">dest_patterns</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, sep<span class="op">=</span><span class="st">"/"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># Merge datatable objects</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">BAS</span>,<span class="va">BIT</span>,<span class="va">PAYG</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    
    <span class="va">ind_items</span> <span class="op">&lt;-</span> <span class="va">i</span><span class="op">[</span><span class="va">ind_items</span>, on <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">id</span>,<span class="va">tsid</span><span class="op">)</span><span class="op">]</span>
<span class="op">}</span></code></pre></div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="index.html"><span class="header-section-number">1</span> Preface</a></div>
<div class="next"><a href="madip.html"><span class="header-section-number">3</span> MADIP</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#BLADE"><span class="header-section-number">2</span> BLADE</a></li>
<li>
<a class="nav-link" href="#general-structure-of-blade"><span class="header-section-number">2.1</span> General Structure of BLADE</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#tau-or-abn-levels"><span class="header-section-number">2.1.1</span> TAU or ABN levels</a></li></ul>
</li>
<li>
<a class="nav-link" href="#blade-utils-in-r"><span class="header-section-number">2.2</span> BLADE Utils in R</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#append-multiple-time-periods-together"><span class="header-section-number">2.2.1</span> Append multiple time periods together</a></li>
<li><a class="nav-link" href="#merging-blade-core-datasets"><span class="header-section-number">2.2.2</span> Merging BLADE core datasets</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>ABS DataLab Manual</strong>" was written by Elyse Dwyer. It was last built on 2022-05-12.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
